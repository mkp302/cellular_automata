\documentclass[11pt,a4paper,fleqn]{article}

\usepackage[ansinew]{inputenc}
\usepackage[mathscr]{eucal}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{hyperref}

\allowdisplaybreaks
\flushbottom

\setlength{\textwidth}{160.0mm}
\setlength{\textheight}{245.0mm}
\setlength{\oddsidemargin}{0mm}
\setlength{\evensidemargin}{0mm}
\setlength{\topmargin}{-15mm} %{-20mm} for arXiv, {-15mm} for printing on A4
\setlength{\parindent}{5.0mm}

\hypersetup{colorlinks, linkcolor=blue, citecolor=blue, urlcolor=blue}

%\bibliographystyle{biblio}

\makeatletter
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip\footnotesize
  \sbox\@tempboxa{#1. #2}%
  \ifdim \wd\@tempboxa >\hsize
    #1. #2\par
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}
\makeatother

\marginparwidth=17mm \marginparsep=1mm \marginparpush=4mm

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{proposition}{Proposition}
{\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}
\newtheorem*{remark*}{Remark}
}


\begin{document}

\par\noindent {\LARGE\bf
Modeling Forest Fires with Cellular Automata
\par}

\vspace{6mm}\par\noindent{\bf
Mark Power$^{\dag}$
}

\vspace{6mm}\par\noindent{\it
$^\dag$\,Department of Mathematics and Statistics, Memorial University of Newfoundland,\\
$\phantom{^\dag}$\,St.\ John's (NL) A1C 5S7, Canada
}

\vspace{6mm}\par\noindent
E-mails:
mkp302@mun.ca


\vspace{9mm}\par\noindent\hspace*{8mm}\parbox{140mm}{\small\looseness=-1
This research applies a cellular automata model to simulate the 2025 forest fire in Kingston Newfoundland. It combines topological and meteorological data to demonstrate that a  simple computation model can be effective at modelling complex fire dynamics.
}\par\vspace{5mm}


Keywords:
Forest fire modelling,
Cellular automata,
Climate Data


\section{Introduction}
\subsection{Cellular Automata}
A cellular automata is a computational model used to simulate complex processes. It consists of a discrete N by N grid of cells, with each cell having its own internal state. The state of each cell is usually over some discrete timestep with each cell's subsequence state depending on a neighbourhood of cells around it. A neighbourhood of cells is usually defined the cells adjacent to it in the grid. The rules governing how cells are updated are generally quite simple, making the simulations less computationally demanding compared to physical models. \\\\

There are many practical applications of Cellular Automata simulations. The key insight is that cellular automata models take advantage of locality. For example, one domain these models excel in modelling is the spread forest fires. Typically, a fire will only spread to sections of a forest close to the fire front making it quite suitable for modelling with cellular automata.\\

This research uses the Kingston fire as a case study to develop a forest fire model.


\section{Case Study}
In 2025 hot and dry weather during the month of August lead to multiple forest fires breaking out across Newfoundland. One of the most devastating fires occurred in Conception bay North. The fire started on August 3rd near the town of Kingston. By August 5th it had grown to 720 hectares leading many residents to be evacuated. Throughout, the month of August the fire continued to grow, and it wasn't until August 30th that the fire was listed as being under control and evacuation orders were lifted. \\\\

The seriousness of this fire demonstrates the need to have an accurate model of how forest fires develop. Being able to predict the spread of a fire, could help in forest fire efforts by predicting what areas to focus on allowing more effective fire suppression efforts. It would also aid in evacuation orders, showing which communities could potentially be in danger.



\section{Wang Zhengfei Forest Fire Model}
This research uses the Wang Zhengfei Forest Fire Model as basis for calculating how fast a fire spreads. \\\\

The Wang Zhengfei model is set of empirical equations that are used to calculate the spread rate of a forest fire. It starts with an estimation for an initial spread rate, which is further modified by several constants. These constants incorperate both wind and terrain data.\\\\

The general form of the Wang Zhengfei equation is:
$$R = R_0 K_s K_w K_{\phi}/cos(\alpha)$$

$R_0$ is the initial spread rate, it is usually determined empirically by ignition experiments, where relevant material is burned in the absence of wind. \\\\

$K_s$ is the fuel configuration constant, it depends on the type and density of the fuel being burned. For example, a fire will spread much faster in a dense forest than a sparse forest. \\\\\


$K_w$ is the wind correction term given by: \\\\

$$K_w = 0.969 e^{0.1783V}$$ where V is the wind speed in m/s. \\\\

$K_{\phi}$ is the terrain correction factor. Fires spread much faster on steeper inclines compared to flat ground.

Combining the constants gives a direct form of the Wang Zhengfei equations are listed in \ref{tab:spread-rates}:w

\begin{table}[h!]
\centering
\caption{Spread rate formulas for different slope and wind directions.}
\label{tab:spread-rates}
\begin{tabular}{|l|l|}
\hline
\textbf{Condition} & \textbf{Spread Rate Formula} \\
\hline
Uphill &
$R_{\text{uphill}} =
0.969\, R_0\, K_s\, e^{3.533(\tan \phi)^{1.2} + 0.182\, V \cos \theta}$ \\[6pt]
\hline
Downhill &
$R_{\text{downhill}} =
0.969\, R_0\, K_s\, e^{-3.533(\tan \phi)^{1.2} + 0.182\, V \cos(180^\circ - \theta)}$ \\[6pt]
\hline
Left (flat slope) &
$R_{\text{left}} =
0.969\, R_0\, K_s\, e^{0.182\, V \cos(\theta + 90^\circ)}$ \\[6pt]
\hline
Right (flat slope) &
$R_{\text{right}} =
0.969\, R_0\, K_s\, e^{0.182\, V \cos(\theta - 90^\circ)}$ \\[6pt]
\hline
Wind (favourable direction) &
$R_{\text{wind}} =
0.969\, R_0\, K_s\, e^{3.533(\tan(\phi \cos \theta))^{1.2} + 0.182\, V},
\quad
\text{if } \theta \in [0^\circ, 90^\circ] \cup [270^\circ, 360^\circ]$ \\[6pt]
\hline
Wind (opposing direction) &
$R_{\text{wind}} =
0.969\, R_0\, K_s\, e^{-3.533(\tan(\phi \cos(180^\circ - \theta)))^{1.2} + 0.182\, V},
\quad
\text{if } 90^\circ < \theta < 270^\circ$ \\[6pt]
\hline
\end{tabular}
\end{table}
\section{Data and Methods}\label{sec:Data and Methods}

\subsection{Datasets}
Several datasets are used in the fire spread algorithm.

From the European Centre for Medium-Range Weather Forecasts's (ECMRWF) Reanalysis v5 (ER5) dataset, wind velocity and temperature data was collected during month of August. The reanalysis data latitudinal/longitudinal grid was too coarse grained for the cellular automata grid, so values were sampled near Kingston and it was assumed these held constant across the North Shore area.\\\\

Elevation data was collected from the NASA Shuttle Radar Topography Mission (SRTM) dataset. The topological data was imported into the project from a tif image. Each pixel in the tif image encoded the elevation height in m above sea level. The difference in elevation was then used to calculate the slope/aspect for each cell in the simulation. Some pre-processing had to be done to map the coordinates to the simulation grid since the projection method used in the dataset (SRTM) dataset did not align with the grid. \\\\

These values were used in the model's algorithm to update each cell.

\subsection{Algorithm}
The Forest fire Model consists of a 300 by 300 grid of cells, with each cell representing a section of forest. The grid represents an area of around $42 km^2$ around the Kingston area. 

Each cell can be in one of four states:

\begin{table}[h!]
\centering
\caption{Internal State of Cells}
\begin{tabular}{|l|l|p{6cm}|}
\hline
\textbf{State} & \textbf{Condition} & \textbf{Description} \\
\hline
0 & Non-flammable & 
The section of forest represents terrain features that are not flammable such as lakes or rivers \\
\hline
1:& Unburnt &
This section of forest contains fuel that has not yet ignited \\
\hline
2:& Burning &
This section of forest contains fuel that is now burning \\
\hline
3:& Burnt out &
This section of forest has run out of fuel and is no longer burning\\
\hline

\end{tabular}
\end{table}

The algorithm for updating each cell after some time step $\delta t$ is as follows:

For each cell in the grid, we first check if it is in the burning state. If it is, we iterate over each neighbouring cell and calculate how fast the fire is spreading in that direction. The formula used to calculate the spread rate of the fire is $R_wind$ from: \ref{tab:spread-rates} The wind speed V is calculated using the wind vector from the ER5 dataset. The aspect $\phi$ is calculated using the difference in elevation between neighbouring cells. and the wind direction $\theta$ is calculated using difference in angle between the wind vector and the direction vector to the neighbouring cell. 

\begin{table}[h!]
\centering
\caption{Neighbouring cells relative to the central cell $(i, j)$.}
\begin{tabular}{|c|c|c|}
\hline
$(i-1, j+1)$ & $(i, j+1)$ & $(i+1, j+1)$ \\ \hline
$(i-1, j)$   & $(i, j)$   & $(i+1, j)$   \\ \hline
$(i-1, j-1)$ & $(i, j-1)$ & $(i+1, j-1)$ \\ \hline
\end{tabular}
\end{table}

Each section of forest, roughly corresponds to a $90m^2$ area. So, given the time elapsed from the last update, $\Delta t$, we then calculate how far the fire has spread $\text{Distance} = \text{Spread Rate } * \Delta t$. If the neighbouring cell is unburnt, and the fire has spread far enough to reach that cell then we update the neighbouring cell to be burning. After enough time has elapsed a burning cell will be out of fuel, it then transitions to the burnt out state. \\\\
 
Cells at the edge of the grid do not have 8 neighbours. To remedy this, extra cells are added around the perimeter of the grid. The extra cells are only used to update cells at the edge of the grid and do not factor into the simulation. \\\\


\subsection{Implementation}

The algorithm was implemented in python and used the pygame and pygame\_gui libraries to visualize the results. The pygame library provides methods for creating a window and drawing objects on the screen. The pygame\_gui library provides support for user interface widgets such as buttons and text boxes. The 300 by 300 grid of cells is drawn to the screen with each pixel representing a section forest. A green colour is used to represent unburnt cells, blue is used to represent non-flammable cells, red is used to represent cells that are burning and black is used to represent cells that are burnt out  \\\\

To initialize the grid, a stencil was created using a terrain map. Non-flammable features such as lakes and rivers were masked using an image processing program called GIMP. The image was scaled to an appropriate size to create a 300 by 300 grid. The elevation date was also imported and projected onto each cell in the grid\\\\

\begin{figure}[h]
\caption{Stencil used to mask non-flammable features}
\centering
\includegraphics{stencil_3.png}
\end{figure}

A time step of 30 minutes was chosen to have the simulation run at a reasonable speed. During each update, a utc timestamp was updated and used to query the ER5 dataset.The simulation was run for 2 weeks in simulation time. At relevant timestamps a screenshot was taken so it could be compared to satellite images of how the fire really spread.

\begin{figure}[h]
\caption{Forest Fire Simulation App}
\centering
\includegraphics{final_app_design.png}
\end{figure}


\section{Results}\label{sec:Results}
The simulation output was qualitatively compared against satellite images taken of the real fire as shown in \ref{fig:results}. By overlaying the burn radius of the simulation on top of the satellite images, the model was shown to have agreed strongly with the real fire during the first week of activity. However, after the first week, the simulation appears to outpace the real fire, growing slightly faster. This is to be expected since the real fire was being actively suppressed by forest fighting efforts and this was not taken into account by the model. Overall, the models early correspondence with the real fire demonstrates that a cellular automata perform well in modelling the dynamics of forest fires. 





\begin{figure}[h]
\caption{Satellite Images Showing the Progression of the fire from August 3rd to 17th}
\centering
\includegraphics[width=0.7\textwidth]{CBN_Wildfire_Aug03-17_2025_Visible-1024x791.jpg}
\end{figure}

\begin{figure}[h]
\caption{Results of Simulation Overlaid}
\label{fig:results}
\centering
\includegraphics[width=0.7\textwidth]{results.png}
\end{figure}
\section{Limitations}
There are a number of limitations in the implementation of this model.

The Wang Zhengfei model depends on a number of constants. For example, the initial spread rate $R_0$ depends on moisture levels and the type of fuel being burned. $R_0$ usually determined experimentally by burning material in the absence of wind. Another important variable is the fuel configuration constant, which depends on the density and type of vegetation constant. Unfortunately, there was little data available on reasonable values for these constants for forests in Newfoundland, as much of the research for these models focus on fires occurring in China. In order to come up with reasonable values, I ran multiple simulations trying different parameters and decided on values that performed the best. In the future, there might be value in studying the unique forest landscapes in Newfoundland. 

Another limitation is that this model does not take into account fire fighting efforts. During real forest fires, there are attempts to suppress the fire at the front. For example, during the Kingston fire multiple water bombers were employed. In future work, this could be accounted by artificially lowering the spread rate of the fire across certain cells were fire suppression methods were used. 


\section{Conclusion}\label{sec:Conclusion}
This paper showed that a relatively simple cellular computational model combined with meteorological and topological data can model the complex dynamics of forest fires quite well. With the increasing frequency and severity of forest fires due to climate change these types of models will be valuable for understanding and predicting how forest fires behave. Although simple, this type of model will be a useful tool in supporting firefighting efforts in fire-prone regions.

\section{github}
https://github.com/mkp302/cellular\_automata

\footnotesize\setlength{\itemsep}{0ex}
\bibliography{biblio}

\end{document}
hline
2:& Burning &
This section of forest contains fuel and it is now burning \\
\hline
3:& Burnt out &
This section of forest has run out of fuel and is no longer burning\\
\hline

\end{tabular}
\end{table}

The algorithm for updating each cell after some time step $\delta t$ is as follows:

For each cell in the grid we first check if it is in the burning state. If it is, we then iterate over each neighbouring cell and calculate how fast the fire is spreading in that direction. The formula used is: \ref{tab:spread-rates}

\begin{table}[h!]
\centering
\caption{Neighbouring cells relative to the central cell $(i, j)$.}
\begin{tabular}{|c|c|c|}
\hline
$(i-1, j+1)$ & $(i, j+1)$ & $(i+1, j+1)$ \\ \hline
$(i-1, j)$   & $(i, j)$   & $(i+1, j)$   \\ \hline
$(i-1, j-1)$ & $(i, j-1)$ & $(i+1, j-1)$ \\ \hline
\end{tabular}
\end{table}

Each section of forest, roughly corresponds to a $90m^2$ area. So, given the time elapsed from the last update, $\Delta t$, we can calculate how far the fire has spread $\text{Distance} = \text{Spread Rate } * \Delta t$. If the neighbouring cell is unburnt, and the fire has spread far enough to reach that cell then we update the neighbouring cell to be burning. After enough time has elapsed a burning cell can be out of fuel, it then transitions to the burnt out state. \\
 
Cells at the edge of the grid do not have 8 neighbours. To remedy this, extra cells are added around the perimeter of the grid. The extra cells are only used to update cells at the edge of the grid and do not factor into the simulation.



\begin{table}[h!]
\centering
\caption{Neighbour positions relative to cell $(i, j)$ and favourable wind directions.}
\begin{tabular}{|c|c|c|}
\hline
\textbf{Neighbour} & \textbf{Grid Offset $(\Delta i, \Delta j)$} & \textbf{Favourable Wind Direction (°)} \\
\hline
Top-left     & (-1, -1) & 315° (Northwest) \\
Top          & (-1,  0) & 0° (North) \\
Top-right    & (-1, +1) & 45° (Northeast) \\
Left         & ( 0, -1) & 270° (West) \\
Right        & ( 0, +1) & 90° (East) \\
Bottom-left  & (+1, -1) & 225° (Southwest) \\
Bottom       & (+1,  0) & 180° (South) \\
Bottom-right & (+1, +1) & 135° (Southeast) \\
\hline
\end{tabular}
\end{table}

\subsection{Implementation}

The algorithm was implemented in python and used the pygame and pygame_gui libraries to visualize the results. \\

To initialize the grid, a stencil was created using a terrain map. Non-flammable features were masked using an image processing program called GIMP. The image was scaled to an appropriate size to create a 300 by 300 grid.  \\\\
\begin{figure}[h]
\caption{Stencil used to mask non-flammable features}
\centering
\includegraphics{stencil_3.png}
\end{figure}

The topology data was imported into the project from a '.tif' image. Some pre-processing had to be done to map the coordinates of the elevation data to the grid.


\section{Results}\label{sec:Results}
The simulation was run for 2-weeks simulation time. At relevant timestamps a screenshot taken to be compared satellite images of how the fire really spread.\\\\





\begin{figure}[h]
\caption{Satellite Images Showing the Progression of the  fire from August 3rd to 17th}
\centering
\includegraphics[width=0.7\textwidth]{CBN_Wildfire_Aug03-17_2025_Visible-1024x791.jpg}
\end{figure}

\begin{figure}[h]
\caption{Results of Simulation Overlaid}
\centering
\includegraphics[width=0.7\textwidth]{results.png}
\end{figure}
\section{Limitations}
There are a number of limitations in the implementation of this model.

The Wang Zhengfei model depends on a number of constants. For example, the initial spread rate $R_0$ depends on moisture levels and the type of fuel being burned. $R_0$ usually determined experimentally by burning material in the absence of wind. Another important variable is the fuel configuration constant which depends on the density and type of vegetation constant. Without having access to relavent data, these constants had to be estimated using reasonable assumptions.  

Another limitation is that this model does not take into account fire fighting efforts. During real forest fires, there are attempts to suppress the fire at the front. For example, during the Kingston fire, multiple water bombers were employed. In future work this could be accounted for by artificially lowering the spread rate of the fire across certain cells were fire suppression methods were used. 


\section{Conclusion}\label{sec:Conclusion}
Despite simplifications made to the Wang Zhengfei model, the Cellular PErformed performed well at predicting how the fire spread in the short term. Comparing the output of the simulations to the satellite images of the fire  

\section{github}
https://github.com/mkp302/cellular\_automata

\footnotesize\setlength{\itemsep}{0ex}
\bibliography{biblio}

\end{document}

